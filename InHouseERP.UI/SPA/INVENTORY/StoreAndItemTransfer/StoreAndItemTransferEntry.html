<!DOCTYPE html>
<html>
<head>

    <style type="text/css">

        body {
            font-family: "Times New Roman", Times, serif;
            color: #000000;
            height: auto;
            font-size: 15px;
        }

        #MainTable td {
            text-align: center;
        }

        @page {
            size: A4 landscape;
        }

        .flexcontainer {
            display: flex;
            justify-content: space-between;
        }

        #UpperTable td {
            border-collapse: collapse;
            padding: 5px;
        }

        #container {
            width: 100%;
            bottom: 0;
            position: fixed !important;
        }

        #left {
            float: left;
            width: 100px;
        }

        #right {
            float: right;
            width: 100px;
        }

        #center {
            margin: 0 auto;
            width: 100px;
        }
    </style>

</head>
<body>
    <!--<page>-->
    <table class="table" style="margin: auto !important;">
        <tbody>
            <tr>
                <td>
                    <div class="container hidden-print">
                        <div class="col-sm-7 col-md-9">

                        </div>
                        <div class="row">
                            <div class="col-sm-3 col-md-2">
                                <!--<button type="button" onclick="ExportToDoc();" class="customBtn custmoBtnReset" style="border-radius: 3px; margin-bottom: -.9em; margin-top: -15px; padding-bottom: 3px; padding-top: 3px;" title="Export to .doc">
                                    <i class="fa fa-save"></i>&nbsp;Export to .doc
                                </button>-->
                            </div>
                            <div class="col-sm-2 col-md-1">
                                <button type="button"  onclick="document.title = 'Store Item Transfer' + getCurrentDateTime(); PrintPdf();"  class="customBtn custmoBtnReset" style="border-radius: 3px; margin-bottom: -.9em; margin-top: -15px; padding-bottom: 3px; padding-top: 3px;" title="Print To .PDF">
                                    <i class="fa fa-print"></i>&nbsp;Print
                                </button>
                            </div>


                        </div>
                        <br />
                    </div>

                    <div id="source-html">


                        <table id="heading" style="text-align: center;margin-left:auto;margin-right:auto;">

                            <tr>
                                <td>
                                    <img style="height: 80px; width: 80px; padding: 5px" src="../../../UploadedImages/rtlLogo.jpg" />
                                </td>
                                <td>
                                    <p style="font-size: 30px;line-height: 1; margin : 0; padding : 0 ; font-weight: bold;"><strong>Retail Technologies Limited</strong></p>
                                    <p style="font-size: 14px; line-height: 1.5; margin : 0; padding : 0 ;">
                                        Address: {{StoreAndItemTransfer[0].BranchAddress}}
                                    </p>
                                    <span style="font-size: 18px; line-height: 1; margin: 0; padding: 0;"><i><u><b>{{ReportName}}</b></u></i></span>
                                </td>
                            </tr>
                        </table>
                        <span style="font-size: 14px; line-height: 1; margin: 0; padding: 0;"><b>Date: </b>{{StoreAndItemTransfer[0].StockTransferDate}}</span>
                        <br />
                        <span style="font-size: 14px; line-height: 1; margin: 0; padding: 0;"><b>Form Store </b>{{StoreAndItemTransfer[0].FromDepartmentName}}</span>
                        <br />
                        <span style="font-size: 14px; line-height: 1; margin: 0; padding: 0;"><b>To Store: </b>{{StoreAndItemTransfer[0].ToDepartmentName}}</span>

                        <br />
                        <table id="MainTable" border="1" width="100%" align="center">
                            <thead>
                                <tr>
                                    <th style="text-align: center">SL No</th>
                                    <th style="text-align: center" ng-show="StoreAndItemTransfer[0].StockTransferTypeId==3">Item Name</th>
                                    <th style="text-align: center" ng-show="StoreAndItemTransfer[0].StockTransferTypeId==4">Form Item Name</th>
                                    <th style="text-align: center" ng-show="StoreAndItemTransfer[0].StockTransferTypeId==4">To Item Name</th>

                                    <th style="text-align: center" ng-show="StoreAndItemTransfer[0].StockTransferTypeId==3">Material Type</th>
                                    <th style="text-align: center" ng-show="StoreAndItemTransfer[0].StockTransferTypeId==4">Form Material Type</th>
                                    <th style="text-align: center" ng-show="StoreAndItemTransfer[0].StockTransferTypeId==4">To Material Type</th>
                                    <th style="text-align: center">Label Brand Name</th>


                                    <th style="text-align: center">Transfer Qty (Pcs)</th>
                                    <th style="text-align: center">Remarks</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="aISTM in StoreAndItemTransfer track by $index">
                                    <td>
                                        {{$index+1}}
                                    </td>
                                    <td ng-show="StoreAndItemTransfer[0].StockTransferTypeId==3">
                                        <span style="font-size: .9em;">{{aISTM.ItemName}}</span>
                                    </td>
                                    <td ng-show="StoreAndItemTransfer[0].StockTransferTypeId==4">
                                        <span style="font-size: .9em;">{{aISTM.ItemName}}</span>
                                    </td>
                                    <td ng-show="StoreAndItemTransfer[0].StockTransferTypeId==4">
                                        <span style="font-size: .9em;">{{aISTM.To_ItemName}}</span>
                                    </td>

                                    <td ng-show="StoreAndItemTransfer[0].StockTransferTypeId==3">
                                        <span style="font-size: .9em;">{{aISTM.MaterialTypeName}}</span>
                                    </td>
                                    <td ng-show="StoreAndItemTransfer[0].StockTransferTypeId==4">
                                        <span style="font-size: .9em;">{{aISTM.MaterialTypeName}}</span>
                                    </td>
                                    <td ng-show="StoreAndItemTransfer[0].StockTransferTypeId==4">
                                        <span style="font-size: .9em;">{{aISTM.To_MaterialTypeName}}</span>
                                    </td>
                                    <td>
                                        <span style="font-size: .9em;">{{aISTM.LabelBrandName}}</span>
                                    </td>
                                    <td>
                                        <span style="font-size: .9em;">{{aISTM.Qty}}  {{aISTM.UnitName}}</span>
                                    </td>

                                    <td>
                                        <span style="font-size: .9em;">{{aISTM.Remarks}}</span>
                                    </td>

                                </tr>
                            </tbody>
                        </table>
                        <br />
                        <br />
                        <br />
                        <div id="container">
                            <div id="left">
                                <table>
                                    <tr>
                                        <td>
                                            <hr style="border-top: 1px solid black;">
                                            <span style="font-size: .9em; line-height: 1; margin : 0; padding : 0 ; font-weight: bold;">Check By</span>
                                        </td>
                                    </tr>
                                </table>

                            </div>
                            <div id="right">
                                <table>
                                    <tr>
                                        <td>
                                            <hr style="border-top: 1px solid black;">
                                            <span style="font-size: .9em; line-height: 1; margin : 0; padding : 0 ; font-weight: bold;">Received By</span>
                                        </td>
                                    </tr>
                                </table>

                            </div>


                        </div>
                       
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
 

    <script type="text/javascript">
        $('#HtmlData').hide();


        function ExportToDoc() {
        
            $('.hideButton').hide();
            $('#result').hide();


            var sourceHTML = document.getElementById("source-html").innerHTML;


            function escapeRegExp(string) {
                return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
            }
            function replaceAll(str, term, replacement) {
                return str.replace(new RegExp(escapeRegExp(term), 'g'), replacement);
            }
            var removeTableBorderStr;
            $('#ciTable tbody tr td').each(function (tdIndex, td) {
                var preStyle = $(this).attr("style");

                if (preStyle != undefined) {
                    var pos = preStyle.indexOf("display: none;");
                    if (pos != -1) {
                        $('#ciTable').find("tbody tr td:nth-child(" + tdIndex + ")").each(function () {

                            $(this).remove();

                            alert();
                        });


                    }
                }

            });


            var thCount = 8;
            
            if (thCount <= 10 && thCount > 0) {
                removeTableBorderStr = replaceAll(sourceHTML, 'style="width: 100% !important; font-size: .9em; font-family: "Times New Roman", Times, serif; color:#000000; text-align:center; margin:0; padding:0;', 'style="width: 100% !important; text:align:center; border: 1px solid black; border-collapse: collapse; font-size: .9em; font-family: "Times New Roman", Times, serif; color:#000000; margin:0; padding:0;');
            }
            else if (thCount <= 15 && thCount > 10) {
                removeTableBorderStr = replaceAll(sourceHTML, 'style="width: 100% !important; font-size: .9em; font-family: "Times New Roman", Times, serif; color:#000000; text-align:center; margin:0; padding:0;', 'style="width: 100% !important; text:align:center; border: 1px solid black; border-collapse: collapse; font-size: .7em; font-family: "Times New Roman", Times, serif; color:#000000; margin:0; padding:0;');
            }
            else {
                alert('Please insert less then 15 column.');
                return;
            }

        
            var source = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(removeTableBorderStr);
            var fileDownload = document.createElement("a");
            document.body.appendChild(fileDownload);
            fileDownload.href = source;
            fileDownload.download = 'Commercil Invoice.doc';
            fileDownload.click();
            document.body.removeChild(fileDownload);
            $('.hideButton').show();
            $('#result').show();
         
        }


        function PrintPdf() {

            window.print();

        }
        jQuery(document).ready(function ($) {

            $(".main-sidebar").attr("hidden", true);
            $(".main-header").attr("hidden", true);
            $(".main-footer").attr("hidden", true);
            $("#Hidebr").attr("hidden", true);

            $("div").removeClass("wrapper");
            $("div").removeClass("content-wrapper");
        });


    </script>
</body>

</html>
